<div class="publishedInfo">
	<div class="search">
		<input type="text" id="date" name="username" lay-verify="required" placeholder="请输入" autocomplete="off" class="layui-input">
		<button type="submit" class="layui-btn layui-btn-normal">搜索</button>
	</div>
	
	<form action="" class="layui-form" lay-filter="msg-search-form">
		<div class="type layui-input-block">
			<select name="" id="infoType" lay-filter="listType">
				<option value="1">国家政策</option>
				<option value="2">院校政策</option>
				<option value="3">考研资讯</option>
				<option value="4">学习方法</option>
			</select>
		</div>
	</form>
	
	
	<div class="main-l-body">
		<ul class="body-list" id="bodyList">
				
		</ul>
		<div id="page" class="page"></div>
	</div>
</div>
<!--<script src="js/filldata.js" type="text/javascript" charset="utf-8"></script>-->
<script>
var pages; //当前请求数据总数
//载入执行
//$(document).ready(function(){
	fillData(1,1);//默认将列表填充为type=1
	
	

	layui.use('laypage', function() {
		var p=parseInt(pages);
		var laypage = layui.laypage;
		laypage.render({
			elem: 'page'
			,count: p 
			,limit: 20
		});
	});
	
//});
layui.use('form', function(){
	var form = layui.form;
	//监听下拉事件
	form.on('select(listType)', function(data){
		type = data.value; //得到被选中的值
					  	
		fillData(type,1);
		var p = parseInt(pages);
		layui.use('laypage', function() {
			var laypage = layui.laypage;
							
			//执行一个laypage实例
			laypage.render({
				elem: 'page' //注意，这里的 test1 是 ID，不用加 # 号
				,count: p //数据总数，从服务端得到
				,limit: 20
			});
		});
	});
				
	form.render(null, 'msg-search-form');

})

  


	
//填充数据列表的请求函数	
function fillData(type,page){
	$('#bodyList').html('');
	var type=type;
	var page=page;
	var listData;
	console.log(type);
	console.log(page);
	$.ajax({
			async:false,
			url: "publishedInfo.php",
			type: "POST",
			data:{
				type: type,
				page: page
			},
			success: function(response, status, xhr) {
				listData = JSON.parse(response); 
				pages=listData.length;
				if(listData.length>10){
//					listLength
				}
				for(var i=0;i<listData.length;i++){
					var list = '<li><a href="">'+ listData[i].title +'</a><span class="span-time">'+ listData[i].date +'</span><a href="###" class="list-btn btnBlue">查看</a><a href="###" class="list-btn btnOrg">删除</a></li>';
					$('#bodyList').append(list);
					
				}	
			}
	});
}
	
	
	
	
	
	
	
</script>